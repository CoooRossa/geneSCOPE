% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/13.PlotNetWork.r
\name{buildMultiClusterDendrogramRW}
\alias{buildMultiClusterDendrogramRW}
\title{Random-walk-weighted multi-cluster dendrogram}
\usage{
buildMultiClusterDendrogramRW(
  coordObj,
  grid_name = NULL,
  lee_stats_layer = "LeeStats_Xz",
  graph_slot = "g_consensus",
  cluster_name,
  cluster_ids = NULL,
  cmh_slot = "g_morisita",
  use_mh_avg = TRUE,
  IDelta_col_name,
  linkage = "average",
  dist_mode = c("one_minus", "inverse"),
  plot_dend = TRUE,
  weight_low_cut = 0,
  damping = 0.85
)
}
\arguments{
\item{coordObj}{A \code{CoordObj} containing \code{@grid} with a
consensus gene–gene graph and associated metadata.}

\item{grid_name}{Character. Grid sub-layer to use; if \code{NULL}
the first layer is chosen automatically.}

\item{lee_stats_layer}{Name of the Lee's statistics layer
(default \code{"LeeStats_Xz"}).}

\item{graph_slot}{Slot that stores the consensus graph
(default \code{"g_consensus"}).}

\item{cluster_name}{Column in \code{meta.data} that assigns genes to
clusters.}

\item{cluster_ids}{Character vector of cluster labels to include;
if \code{NULL} all labels in \code{cluster_name}
are used.}

\item{cmh_slot}{Slot containing the Morisita–Horn graph
(default \code{"g_morisita"}).}

\item{use_mh_avg}{Logical. If \code{TRUE} average Lee's L and
Morisita–Horn when both are present.}

\item{IDelta_col_name}{Column in \code{meta.data} with Δ statistics used
to build the personalised PageRank vector.}

\item{linkage}{Linkage method passed to \code{hclust}
(e.g. \code{"average"}, \code{"complete"}).}

\item{dist_mode}{Either \code{"one_minus"} to use
\eqn{1 - S / \max(S)} or \code{"inverse"} to use
\eqn{1/(S + 1e-6)} as the distance measure.}

\item{plot_dend}{Logical. Draw the dendrogram if \code{TRUE}
(default).}

\item{weight_low_cut}{Numeric. Edge weights at or below this value are
set to zero after PageRank scaling.}

\item{damping}{Damping factor for personalised PageRank
(range 0–1; default 0.85).}
}
\value{
Invisibly returns a list with components:
\describe{
\item{\code{dend}}{A \code{dendrogram} object.}
\item{\code{hclust}}{The underlying \code{hclust} object.}
\item{\code{dist}}{The distance matrix used for clustering.}
\item{\code{genes}}{Character vector of genes included.}
\item{\code{cluster_map}}{Named vector mapping genes to clusters.}
\item{\code{PageRank}}{PageRank scores for the included genes.}
}
}
\description{
Constructs a dendrogram of selected gene clusters by propagating
personalized PageRank scores over a Lee's-L consensus graph, rescaling
edge weights, transforming similarities to distances, and applying
hierarchical clustering.  The procedure highlights genes that are
highly connected within and between user-specified clusters, producing
an intuitive tree that can be plotted or further analysed.
}
\details{
Edge weights in the consensus graph are first re-weighted by the mean
personalised PageRank of their incident vertices, emphasising genes that
rank highly under the chosen \code{IDelta_col_name}.  Very weak edges
(\code{<= weight_low_cut}) are removed.  The remaining similarity matrix
is converted to a distance matrix according to \code{dist_mode} and fed
to \code{hclust}.  The default \code{linkage = "average"} reproduces the
legacy behaviour.  Setting \code{plot_dend = TRUE} calls the base
graphics plotting method with a descriptive title.
}
\examples{
\dontrun{
dend_res <- buildMultiClusterDendrogramRW(
    coordObj        = P5.coord,
    grid_name       = "25um",
    cluster_name    = "modL0.15",
    cluster_ids     = c("C3", "C5", "C7"),
    IDelta_col_name = "25um_iDelta_raw",
    linkage         = "average",
    dist_mode       = "one_minus",
    plot_dend       = TRUE
)
}
}
