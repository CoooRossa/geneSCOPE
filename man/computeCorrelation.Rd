% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/9.Pearson.r
\name{computeCorrelation}
\alias{computeCorrelation}
\title{Compute gene correlation matrix for grid or cell data}
\usage{
computeCorrelation(
  scope_obj,
  level = c("cell", "grid"),
  layer = "logCPM",
  method = c("pearson", "spearman", "kendall"),
  blocksize = 2000,
  ncores = 16,
  chunk_size = 1000,
  memory_limit_gb = 16,
  store_layer = "pearson_cor",
  compute_fdr = TRUE,
  fdr_method = "BH",
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A \code{scope_object} with populated \code{@grid} or \code{@cells}.}

\item{level}{Character. \code{"grid"} or \code{"cell"}.}

\item{layer}{Character. Layer name to extract.}

\item{method}{Character. Correlation method (currently only \code{"pearson"}).}

\item{blocksize}{Integer. Block size for the C++ correlation computation.}

\item{ncores}{Integer. Number of OpenMP threads.}

\item{chunk_size}{Integer. Chunk size for large matrix processing (default 1000).}

\item{memory_limit_gb}{Numeric. Maximum memory limit for dense operations (default 32GB).}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}

\item{grid_name}{Character (for grid level). Grid sub-layer name.}

\item{force_sparse}{Logical. Force sparse computation even for small matrices (default FALSE).}

\item{gene_subset}{Character vector or NULL. Specific genes to include in correlation analysis.}

\item{max_genes}{Integer. Maximum number of genes to include (triggers automatic selection if exceeded).}

\item{gene_selection_method}{Character. Method for automatic gene selection: "variance", "mean", "dropout", "random".}

\item{save_subset_info}{Logical. Whether to save information about gene selection.}

\item{force_compute}{Logical. Force computation even for very large matrices (default FALSE).}

\item{use_bigmemory}{Logical. Use file-backed matrices for large computations (default TRUE).}

\item{backing_path}{Character. Directory for temporary files (default tempdir()).}

\item{correation_slot_name}{Character. Name of the slot to store correlation matrix (default based on level and layer).}
}
\value{
The modified \code{scope_object} (invisibly).
}
\description{
High-level wrapper that extracts expression data from the specified level
and layer, applies column centering, and computes the Pearson correlation
matrix using the C++ backend \code{pearson_block_cpp()}. The result is
stored in the scope_obj and the modified object is returned.
}
