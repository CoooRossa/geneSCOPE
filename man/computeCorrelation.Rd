% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_correlation.R
\name{computeCorrelation}
\alias{computeCorrelation}
\title{Compute gene-gene correlations.}
\usage{
computeCorrelation(
  scope_obj,
  level = c("cell", "grid"),
  grid_name = NULL,
  layer = "logCPM",
  method = c("pearson", "spearman", "kendall"),
  blocksize = 2000,
  ncores = 16,
  chunk_size = 1000,
  memory_limit_gb = 16,
  use_bigmemory = TRUE,
  backing_path = tempdir(),
  force_compute = FALSE,
  store_layer = ".pearson_cor",
  compute_fdr = TRUE,
  fdr_method = "BH",
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing expression layers.}

\item{level}{Correlation level (`cell` or `grid`).}

\item{grid_name}{Optional grid name when operating on grid-level data.}

\item{layer}{Expression layer name to correlate (e.g., `logCPM`).}

\item{method}{Correlation method (`pearson`, `spearman`, `kendall`).}

\item{blocksize}{Block size passed to the C++ backend (tuning knob).}

\item{ncores}{Number of threads to use.}

\item{chunk_size}{Chunk size used when using file-backed computation.}

\item{memory_limit_gb}{In-memory size threshold (GB) above which file-backed mode is used.}

\item{use_bigmemory}{Whether to allow file-backed computation for large matrices.}

\item{backing_path}{Directory for file-backed artifacts (default `tempdir()`).}

\item{force_compute}{Whether to force recomputation even if cached outputs exist.}

\item{store_layer}{Slot name for storing the correlation matrix.}

\item{compute_fdr}{Whether to compute and store an FDR-adjusted p-value matrix.}

\item{fdr_method}{Multiple-testing adjustment method passed to `p.adjust()`.}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
The updated `scope_object` (invisibly).
}
\description{
Computes a gene × gene correlation matrix from either single-cell expression
(`level = "cell"`) or grid-level expression (`level = "grid"`), stores results
into the `scope_object`, and returns the updated object invisibly.
}
\examples{
\dontrun{
scope_obj <- createSCOPE(data_dir = "/path/to/output_dir",　grid_length = 30)
scope_obj <- addSingleCells(scope_obj, data_dir = "/path/to/output_dir")
scope_obj <- normalizeSingleCells(scope_obj, input_layer = "counts", output_layer = "logCPM", scale_factor = 1e4)
scope_obj <- computeCorrelation(scope_obj, level = "cell", layer = "logCPM", method = "pearson", ncores = 16) 
scope_obj <- computeCorrelation(scope_obj, level = "grid", grid_name = "grid30", layer = "Xz", method = "pearson", ncores = 16)
}
}
\seealso{
`addSingleCells()`, `normalizeSingleCells()`, `computeL()`
}
