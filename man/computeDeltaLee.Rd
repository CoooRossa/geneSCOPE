% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Pearson.r
\name{computeDeltaLee}
\alias{computeDeltaLee}
\title{Compute Δ = Lee's L − Pearson \emph{r} with permutation p‑values \strong{and QC}}
\usage{
computeDeltaLee(
  coordObj,
  grid_name = "grid_lenGrid50",
  lee_stats_layer = "LeeStats_Xz",
  cor_layer_name = "pearson_Xz",
  perms = 1000,
  fdr_method = "BY",
  seed = 1
)
}
\arguments{
\item{grid_name}{Character; name of the grid layer to use.}

\item{lee_stats_layer}{Character; name of the Lee's L sub‑layer to use.}

\item{cor_layer_name}{Character; name of the Pearson correlation sub‑layer to use.}

\item{perms}{Integer; number of permutations to perform.}

\item{fdr_method}{Character; FDR adjustment method (default "BY").}

\item{seed}{Integer; random seed for reproducibility.}

\item{write_back}{Logical; if TRUE, write the results back to
\code{coordObj@grid[[grid_name]][["LeeMinusR_stats"]]}.}
}
\description{
For a given grid layer:
\enumerate{
\item Load Lee's L (\code{lee_stats_layer}) and Pearson correlation (\code{cor_layer_name}).
\item Compute the difference Δ = \strong{L − r}.
\item Perform \code{perms} row‑randomisation permutations via an OpenMP C++ backend
(\code{leeL_minusR_perm_ge_cpp()}), return two‑tailed empirical p‑values and
adjust FDR.
\item Classify gene pairs:
\itemize{
\item \emph{L > 0 & Δ > 0 & FDR < 0.05} → "Spatial‑driven"
\item \emph{L < 0 & Δ < 0}              → "False‑pair"
}
\item \strong{QC metrics} are included in the output (see \emph{Return}).
\item Optionally write the result back to
\code{coordObj@grid[[grid_name]][["LeeMinusR_stats"]]}.
}
}
