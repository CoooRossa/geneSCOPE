% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GeneDensity.r
\name{computeDensity}
\alias{computeDensity}
\title{Compute Grid-Based Density from coordObj (Custom Output Name)}
\usage{
computeDensity(
  coordObj,
  grid_name = NULL,
  density_name = "densityDF",
  cluster_col = NULL,
  cluster_num = NULL,
  layer_name = NULL,
  genes = NULL,
  normalize_method = c("none", "per_grid", "global_gene")
)
}
\arguments{
\item{coordObj}{A coordObj that must contain \code{coordObj@grid[[grid_name]]$grid_info}
and \code{coordObj@grid[[grid_name]]$counts}.}

\item{grid_name}{Character (optional). The name of the grid sublayer to use (e.g. \code{"grid_lenGrid50"}).
If NULL and there is only one sublayer under \code{coordObj@grid}, that sublayer is used;
otherwise, the user must specify it explicitly.}

\item{density_name}{Character. The name under which to save the density results in
\code{coordObj@grid[[grid_name]][[density_name]]}.}

\item{cluster_col}{Character (optional). A column name in \code{coordObj@meta.data} used to select genes by cluster.}

\item{cluster_num}{Integer or character (optional). When \code{cluster_col} is not NULL, select genes where
\code{coordObj@meta.data[[cluster_col]] == cluster_num}.}

\item{genes}{Character vector (optional). Directly specify the list of genes for which to compute density.
If both \code{genes} and \code{cluster_col} are provided, \code{genes} takes priority.}
}
\value{
The modified coordObj, where \code{coordObj@grid[[grid_name]][[density_name]]} is a data.frame
containing:
- grid_id: Grid cell ID
- gx, gy: Grid indices in the x and y directions
- count: Total count of selected genes in that grid cell
- density: count divided by grid cell area (µm²)
- xmin, xmax, ymin, ymax: Grid cell boundary coordinates
}
\description{
Using the existing grid counts in coordObj, compute molecular density per grid cell
based on a specified gene set or cluster information. The result is saved under
\code{coordObj@grid[[grid_name]][[density_name]]} with a user‐specified field name.
}
