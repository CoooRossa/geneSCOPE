% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.GeneDensity.r
\name{computeDensity}
\alias{computeDensity}
\title{computeDensity - save density tables under @density}
\usage{
computeDensity(
  scope_obj,
  grid_name = NULL,
  density_name = "density",
  genes = NULL,
  cluster_col = NULL,
  cluster_num = NULL,
  layer_name = "counts",
  normalize_method = c("none", "per_grid", "global_gene"),
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A \code{scope_object} produced by \code{createSCOPE()}.}

\item{grid_name}{Character (optional). Target grid sub-layer; if
\code{NULL} and only one grid layer exists, that one
is used automatically.}

\item{density_name}{Character. Column name to create / overwrite inside
\code{scope_obj@density[[grid_name]]}.}

\item{genes}{Character vector (optional). Gene symbols to include.
If supplied, this takes priority over
\code{cluster_col}/\code{cluster_num}.}

\item{cluster_col}{Character (optional). Column in
\code{scope_obj@meta.data} that stores cluster labels.}

\item{cluster_num}{Scalar (optional). The cluster value whose member
genes are selected when \code{cluster_col} is given.}

\item{layer_name}{Character. Which count layer inside the grid to read
(default \code{"counts"}).}

\item{normalize_method}{One of \code{"none"}, \code{"per_grid"},
\code{"global_gene"}.
* \strong{none}: raw counts.
* \strong{per_grid}: divide each gene count by the
total counts in that grid-cell.
* \strong{global_gene}: divide each gene count by its
global total across all grids.}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}
}
\value{
The modified \code{scope_object} (invisibly).
}
\description{
For a chosen grid sub-layer, sum the counts of a user-defined gene set
(specified directly or via a cluster in \code{scope_obj@meta.data}),
optionally normalise the counts, divide by the grid-cell area, and write
the result into \code{scope_obj@density[[grid_name]]}.
Each call can add \strong{multiple named density columns} to the same grid-layer
table by using different \code{density_name}s.
}
\details{
3.GeneDensity.r (2025-01-06 rev)
}
