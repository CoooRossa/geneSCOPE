% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/IDelta.r
\name{computeIDeltaMetrics}
\alias{computeIDeltaMetrics}
\title{Compute and Store Raw Iδ Values (Supports Specifying Grid Sublayer and Normalization)}
\usage{
computeIDeltaMetrics(coordObj, grid_name = NULL)
}
\arguments{
\item{coordObj}{A \code{coordObj} that already contains outputs of \code{countMPG}, \code{normalizeMPG} (if using normalized data), and \code{computeSpatialWeights}.}

\item{grid_name}{Character (optional). Name of the grid sublayer to use (e.g., \code{"grid_lenGrid50"}).
If NULL and \code{coordObj@grid} has exactly one sublayer, that sublayer is used. Otherwise, this parameter is required.}

\item{normalized}{Logical (default FALSE). Whether to use the normalized matrix:
- FALSE: use \code{coordObj@grid[[grid_name]]$counts} (raw counts).
- TRUE: use \code{coordObj@grid[[grid_name]]$Xz} (Z‐score normalized matrix).}
}
\value{
The modified \code{coordObj}, where:
• \code{coordObj@grid[[grid_name]]$iDeltaStats} is a list containing:
- \code{genes}: Character vector of gene IDs.
- \code{delta_raw}: Named numeric vector of each gene’s raw Iδ value.
• A new column named \code{"<grid_name>_iDelta_raw"} (or \code{"<grid_name>_iDelta_nor"} if \code{normalized = TRUE}) is added to \code{coordObj@meta.data}, storing each gene’s raw Iδ.
}
\description{
Read the grid×gene counts (or normalized Z‐score matrix) from a specified sublayer in \code{coordObj@grid},
construct a “gene × grid” sparse or dense matrix, and call the C++ function \code{idelta_cpp} to compute raw Iδ (no further normalization or log transforms).
The results are saved under \code{coordObj@grid[[grid_name]]$iDeltaStats}, and the raw Iδ values are also inserted into \code{coordObj@meta.data}.
}
