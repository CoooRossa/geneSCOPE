% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/6.LeesL.r
\name{computeL}
\alias{computeL}
\title{Add Lee's L statistics to a scope_object}
\usage{
computeL(
  scope_obj,
  grid_name = NULL,
  genes = NULL,
  within = TRUE,
  ncores = 1,
  block_side = 8,
  perms = 1000,
  block_size = 64,
  L_min = 0,
  norm_layer = "Xz",
  lee_stats_layer_name = NULL,
  legacy_formula = FALSE,
  mem_limit_GB = 2,
  chunk_size = 32L,
  use_bigmemory = TRUE,
  backing_path = tempdir(),
  verbose = TRUE,
  ncore = NULL
)
}
\arguments{
\item{scope_obj}{A \code{scope_object} with at least one populated \code{@grid} slot.}

\item{grid_name}{Character. Name of the grid sub-layer to process. If
\code{NULL} and only one sub-layer exists, it is selected automatically.}

\item{genes}{Optional character vector of genes to include; if \code{NULL}
all genes are used.}

\item{within}{Logical. If \code{TRUE} restrict analysis to the selected
gene set on both axes (default). Otherwise compute gene Ã— all.}

\item{ncores}{Integer. Number of cores for parallel processing (default 1).}

\item{block_side}{Integer. Number of grid cells per side for block partitioning (default 8).}

\item{perms}{Integer. Number of permutations for Monte-Carlo p-values (default 1000).}

\item{block_size}{Integer. Number of permutations processed per batch (default 64).}

\item{L_min}{Numeric threshold used when building the QC similarity graph.}

\item{norm_layer}{Character. Name of the normalised expression layer (default "Xz").}

\item{lee_stats_layer_name}{Character. Name for the output statistics layer.}

\item{legacy_formula}{Logical. Use legacy denominator for compatibility.}

\item{mem_limit_GB}{Numeric. RAM threshold that triggers streaming mode (default 8).}

\item{chunk_size}{Integer. Number of columns processed per chunk (default 128).}

\item{use_bigmemory}{Logical. Use file-backed matrices for large computations (default TRUE).}

\item{backing_path}{Character. Directory for temporary files (default tempdir()).}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}

\item{ncore}{Deprecated. Use \code{ncores} instead.}
}
\value{
The modified \code{scope_object}.
}
\description{
High-level wrapper that computes Lee's L, analytical Z-scores, empirical
p-values via block permutations, FDR, spatial gradients, quality-control
metrics, and stores everything under a new layer in \code{@grid}.
}
