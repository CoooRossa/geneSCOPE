% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/10.LvsRcurve.r
\name{computeLvsRCurve}
\alias{computeLvsRCurve}
\title{Simplified and robust Lee's L vs Pearson r bootstrap curve (ensure CI output)}
\usage{
computeLvsRCurve(
  scope_obj,
  grid_name,
  level = c("grid", "cell"),
  lee_stats_layer = "LeeStats_Xz",
  span = 0.45,
  B = 1000,
  deg = 1,
  ncore = max(1, parallel::detectCores() - 1),
  length_out = 1000,
  downsample = 1,
  n_strata = 50,
  k_max = Inf,
  jitter_eps = 0,
  ci_method = c("percentile", "basic", "bc"),
  ci_adjust = c("none", "analytic"),
  min_rel_width = 0,
  widen_span = 0.1,
  curve_name = "LR_curve2",
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{scope_object}

\item{grid_name}{Grid layer name}

\item{level}{"grid" or "cell"}

\item{lee_stats_layer}{Lee statistics layer}

\item{span}{LOESS span}

\item{B}{Bootstrap iterations}

\item{deg}{0/1}

\item{ncore}{Threads}

\item{length_out}{Number of grid points}

\item{downsample}{Downsample (ratio or integer)}

\item{n_strata}{Number of strata (too large will be truncated to unique r values-1)}

\item{k_max}{LOESS maximum neighbors}

\item{jitter_eps}{Jitter for r}

\item{ci_method}{"percentile","basic","bc"}

\item{ci_adjust}{"none"|"analytic" (only for percentile)}

\item{min_rel_width}{floor minimum relative width (0 to disable)}

\item{widen_span}{floor width smoothing span}

\item{curve_name}{Output name}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}
}
\value{
Modified scope_object
}
\description{
Fit LOESS from (Lee's L, r) upper triangle point set and generate 95\% confidence bands through residual bootstrap.
}
