% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_leesL.R
\name{computeLvsRCurve}
\alias{computeLvsRCurve}
\title{Compute L vs R curve.}
\usage{
computeLvsRCurve(
  scope_obj,
  grid_name,
  level = c("grid", "cell"),
  lee_stats_layer = "LeeStats_Xz",
  span = 0.45,
  B = 1000,
  deg = 1,
  ncores = max(1, detectCores() - 1),
  length_out = 1000,
  downsample = 1,
  n_strata = 50,
  k_max = Inf,
  jitter_eps = 0,
  ci_method = c("percentile", "basic", "bc"),
  ci_adjust = c("none", "analytic"),
  min_rel_width = 0,
  widen_span = 0.1,
  curve_name = "LR_curve2",
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing Lee's L and correlation matrices.}

\item{grid_name}{Grid layer name to operate on.}

\item{level}{Correlation level used for Pearson r (`grid` or `cell`).}

\item{lee_stats_layer}{Lee statistics layer name.}

\item{span}{LOESS span parameter.}

\item{B}{Number of bootstrap iterations.}

\item{deg}{Degree for the LOESS fit.}

\item{ncores}{Number of threads to use.}

\item{length_out}{Grid size for the fitted curve.}

\item{downsample}{Downsampling control (ratio < 1, or target count >= 1).}

\item{n_strata}{Number of strata used when drawing bootstrap samples.}

\item{k_max}{Maximum number of points used per stratum (guards runtime).}

\item{jitter_eps}{Optional jitter factor applied to correlation values.}

\item{ci_method}{Confidence interval method (`percentile`, `basic`, `bc`).}

\item{ci_adjust}{Optional analytic adjustment for CI width.}

\item{min_rel_width}{Minimum relative CI width.}

\item{widen_span}{Additional span widening used when enforcing `min_rel_width`.}

\item{curve_name}{Name under which the curve is stored.}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
The modified `scope_object` with stored curve data.
}
\description{
Computes a smoothed relationship between Lee's L and Pearson correlation using
bootstrapping and stores the fitted curve and confidence intervals into the
`scope_object`.
}
\examples{
\dontrun{
scope_obj <- computeLvsRCurve(scope_obj, grid_name = "grid30", level = "cell", downsample = 0.1, ncores = 16)
}
}
\seealso{
`computeL()`, `computeCorrelation()`, `getTopLvsR()`
}
