% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11.MorisitaHorn.r
\name{computeMH}
\alias{computeMH}
\title{Add Morisita–Horn similarities to a gene–gene network}
\usage{
computeMH(
  scope_obj,
  grid_name = NULL,
  lee_layer = "LeeStats_Xz",
  graph_slot = "g_consensus",
  graph_slot_mh = "g_morisita",
  L_min = 0,
  area_norm = TRUE,
  ncore = 8,
  use_chao = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A \code{scope_object} with populated \code{@grid} slot.}

\item{grid_name}{Character. Grid sub-layer to use. If \code{NULL} and only
one layer exists it is chosen automatically.}

\item{lee_layer}{Name of the layer that contains Lee's statistics
(default \code{"LeeStats_Xz"}).}

\item{graph_slot}{Name of the element that stores, or will store, the
consensus graph built from Lee's L (default
\code{"g_consensus"}). If \code{NULL}, a temporary graph is
constructed on the fly.}

\item{graph_slot_mh}{Name of the element in which to save the graph with
Morisita–Horn edge weights (default \code{"g_morisita"}).}

\item{L_min}{Numeric. Minimum Lee's L value required for an edge.}

\item{area_norm}{Logical. Divide counts by grid area before similarity
calculation (default \code{TRUE}).}

\item{ncore}{Integer. Number of OpenMP threads for the C++ kernel.}

\item{use_chao}{Logical. Apply Chao bias correction when estimating
lambda terms (default \code{TRUE}).}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}
}
\value{
The modified \code{scope_object} (invisibly).  The graph stored in
\code{graph_slot_mh} gains a numeric edge attribute \code{CMH}.
}
\description{
Constructs or retrieves a gene-level network based on Lee's L
(\code{L_min} threshold), computes Morisita–Horn similarity along the
selected edges using the sparse C++ kernel
\code{morisita_horn_sparse_cpp()}, and writes the updated network back
into the chosen grid layer of a \code{scope_object}.
}
\examples{
\dontrun{
coord <- morisitaHorn_on_network2(coord,
    grid_name = "25um",
    L_min     = 0.2,
    ncore     = 8
)
igraph::edge_attr(coord@grid$`25um`$LeeStats_Xz$g_morisita, "CMH")[1:5]
}
}
\seealso{
\code{\link{morisita_horn_sparse_cpp}}
}
