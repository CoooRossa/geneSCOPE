% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/5.SpatialWeights.r
\name{computeSpatialWeights}
\alias{computeSpatialWeights}
\title{Compute Spatial Weight Matrix and listw for a Grid Layer}
\usage{
computeSpatialWeights(
  coordObj,
  grid_name = NULL,
  style = "B",
  store_mat = TRUE,
  zero_policy = TRUE,
  store_listw = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{coordObj}{A \code{CoordObj} with at least one populated
\code{@grid} slot.}

\item{grid_name}{Character. Name of the grid sub-layer to process. If
\code{NULL} and only one sub-layer exists, it is selected
automatically.}

\item{style}{Character weighting style passed to
\code{spdep::nb2listw}. Default \code{"B"} (binary).}

\item{store_mat}{Logical. If \code{TRUE} (default) store the binary
adjacency matrix in \code{$W}.}

\item{zero_policy}{Logical. Forwarded to \code{nb2listw}. When
\code{TRUE} (default) zero-neighbour regions are allowed.}

\item{store_listw}{Logical. If \code{TRUE} (default) store the \code{listw}
object in \code{$listw}.}

\item{verbose}{Logical. Whether to print progress messages (default TRUE).}
}
\value{
The modified \code{CoordObj} is returned invisibly.
}
\description{
Builds a Queen-style neighbour list for the effective grid cells in a
\code{CoordObj} layer, then (optionally) converts it to a binary
\code{dgCMatrix} and/or a \code{listw} object.  All outputs match the
structure produced by the legacy implementation, but are generated via
parallel C++ helpers for speed.
}
\details{
5.SpatialWeights.r (2025-06-27)

The full \eqn{h \times h} Queen lattice (\eqn{h = \max(xbins\_eff,
  ybins\_eff)}) is generated by \code{grid_nb_omp()}, then subset and
relabelled to match active grid IDs in \code{grid_info}.  When
\code{store_mat = TRUE}, the neighbour list is converted to a binary
sparse matrix with \code{listw_B_omp()}, the diagonal is zeroed, and all
non-zero entries are coerced to numeric \code{1}.  Dimension names are set
to \code{grid_id}.
}
\examples{
\dontrun{
coord <- computeSpatialWeights(
  coord,
  grid_name   = "25um",
  style       = "W",
  store_mat   = TRUE,
  store_listw = TRUE
)
}
}
