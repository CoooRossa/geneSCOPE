% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CreateObj.r
\name{createCoordObj}
\alias{createCoordObj}
\title{Build CoordObj from Xenium Output with (Multi‑)Scale Grid Aggregation}
\usage{
createCoordObj(
  xenium_dir,
  lenGrid,
  seg_type = c("cell", "nucleus", "both"),
  filtergenes = NULL,
  max_dist_mol_nuc = NULL,
  filtermolecule = TRUE,
  filterqv = NULL,
  coord_file = NULL,
  ncores = 1L,
  chunk_pts = 5e+05,
  min_gene_types = 1,
  max_gene_types = Inf,
  min_seg_points = 0,
  verbose = TRUE,
  flip_y = FALSE
)
}
\arguments{
\item{xenium_dir}{Path to Xenium output folder.}

\item{lenGrid}{Numeric \strong{vector}. Each value is a square grid side length (µm).}

\item{seg_type}{Character. One of "cell", "nucleus", or "both" (default "cell").}

\item{filtergenes, }{max_dist_mol_nuc, filtermolecule, filterqv, coord_file, ncores, verbose
Same meaning as in v3 (single‑resolution version).}

\item{min_gene_types}{Minimum number of unique gene types required per grid cell (default 1).}

\item{max_gene_types}{Maximum number of unique gene types allowed per grid cell (default Inf).}

\item{min_seg_points}{Minimum number of segmentation points required per grid cell (default 0).}

\item{flip_y}{Logical. Mirror‑flip Y axis if TRUE (default FALSE) so grid aligns
with Xenium Explorer (origin top‑left).}
}
\value{
An S4 \code{CoordObj} with one grid sub‑layer per \code{lenGrid} value, plus \code{centroids} and
\code{segmentation} in \code{coord}.
}
\description{
Streams Xenium \emph{transcripts.parquet} once, applies molecule‑level QC, and \strong{creates several
grid layers at different \code{lenGrid} resolutions in a single pass}.  Segmentation polygons and
centroids are read once and attached unchanged.  Molecule table is discarded to save RAM.

For each \code{lenGrid[i]}, a layer named \verb{grid_lenGrid<value>} is added under \code{coordObj@grid},
containing \code{grid_info}, \code{counts}, and helper metadata.

Additional filters include gene diversity thresholds (\code{min_gene_types}, \code{max_gene_types})
and minimum segmentation points (\code{min_seg_points}) per grid cell.
}
