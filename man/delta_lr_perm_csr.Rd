% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{delta_lr_perm_csr}
\alias{delta_lr_perm_csr}
\title{Monte-Carlo permutation counts for Lee's L minus Pearson r difference (CSR format)}
\usage{
delta_lr_perm_csr(
  Xz,
  W_indices,
  W_values,
  W_row_ptr,
  idx_mat,
  gene_pairs,
  delta_ref,
  n_threads = 1L,
  clamp_nonneg_r = FALSE
)
}
\arguments{
\item{Xz}{n × g numeric matrix of z-scored expression (rows = cells).}

\item{W_indices}{Integer vector of column indices for non-zero elements in CSR format.}

\item{W_values}{Numeric vector of values for non-zero elements in CSR format.}

\item{W_row_ptr}{Integer vector of row pointers in CSR format.}

\item{idx_mat}{n × B integer matrix of 0-based permutation indices.}

\item{gene_pairs}{g × 2 integer matrix of 0-based gene pair indices to test.}

\item{delta_ref}{Numeric vector of reference Delta values for each gene pair.}

\item{n_threads}{Integer. Number of OpenMP threads (default 1).}

\item{clamp_nonneg_r}{Logical; if TRUE clamp Pearson r below 0 to 0 before Delta.}
}
\value{
Integer vector of exceedance counts for each gene pair.
}
\description{
Uses CSR format of spatial weights for better memory efficiency with huge matrices
}
