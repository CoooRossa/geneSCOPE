% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_stats_correlation.R
\name{.compute_correlation}
\alias{.compute_correlation}
\title{Compute pairwise correlation matrices}
\usage{
.compute_correlation(
  scope_obj,
  level = c("cell", "grid"),
  grid_name = NULL,
  layer = "logCPM",
  method = c("pearson", "spearman", "kendall"),
  blocksize = 2000,
  ncores = 16,
  chunk_size = 1000,
  memory_limit_gb = 16,
  use_bigmemory = TRUE,
  backing_path = tempdir(),
  force_compute = FALSE,
  store_layer = ".pearson_cor",
  compute_fdr = TRUE,
  fdr_method = "BH",
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing expression layers.}

\item{level}{Correlation level (`cell` or `grid`).}

\item{grid_name}{Optional grid name when operating on grid-level data.}

\item{layer}{Expression layer name to correlate (e.g., `logCPM`).}

\item{method}{Correlation method (`pearson`, `spearman`, `kendall`).}

\item{blocksize}{Parameter value.}

\item{ncores}{Number of threads to use for computation.}

\item{chunk_size}{Parameter value.}

\item{memory_limit_gb}{Parameter value.}

\item{use_bigmemory}{Logical flag.}

\item{backing_path}{Filesystem path.}

\item{force_compute}{Parameter value.}

\item{store_layer}{Target slot name for storing the correlation matrix.}

\item{compute_fdr}{Whether to compute FDR alongside correlations.}

\item{fdr_method}{Parameter value.}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
The updated scope object (invisibly).
}
\description{
Internal helper for `.compute_correlation`.
}
\keyword{internal}
