% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_metrics_tests.R
\name{.compute_gene_gene_jaccard_heatmap}
\alias{.compute_gene_gene_jaccard_heatmap}
\title{Compute gene–gene Jaccard heatmap}
\usage{
.compute_gene_gene_jaccard_heatmap(
  scope_obj,
  grid_name = "grid30",
  expr_layer = c("Xz", "counts"),
  min_bins_per_gene = 8L,
  top_n_genes = 60L,
  genes_of_interest = NULL,
  output_dir = NULL,
  heatmap_bg = "#c0c0c0",
  cluster_col = NULL,
  keep_cluster_na = TRUE,
  split_heatmap_by_cluster = FALSE,
  verbose = getOption("geneSCOPE.verbose", TRUE)
)
}
\arguments{
\item{scope_obj}{A `scope_object` with grid counts or Xz matrix.}

\item{grid_name}{Grid layer name (default `grid30`).}

\item{expr_layer}{Expression layer to use (`Xz` or `counts`).}

\item{min_bins_per_gene}{Minimum bins per gene required to include.}

\item{top_n_genes}{Number of top genes to plot when no whitelist is given.}

\item{genes_of_interest}{Optional gene whitelist.}

\item{output_dir}{Optional directory to save outputs.}

\item{heatmap_bg}{Parameter value.}

\item{cluster_col}{Optional meta column for cluster labels.}

\item{keep_cluster_na}{Logical flag.}

\item{split_heatmap_by_cluster}{Whether to split heatmap by cluster.}
}
\value{
Invisibly returns the heatmap object (if created).
}
\description{
Internal helper for `.compute_gene_gene_jaccard_heatmap`.
Builds a binary gene × bin matrix and renders a Jaccard similarity heatmap,
optionally stratified by cluster annotations.
}
\keyword{internal}
