% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_leesL.R
\name{.compute_l_vs_r_curve}
\alias{.compute_l_vs_r_curve}
\title{Bootstrap Lee's L vs Pearson r relationship}
\usage{
.compute_l_vs_r_curve(
  scope_obj,
  grid_name,
  level = c("grid", "cell"),
  lee_stats_layer = "LeeStats_Xz",
  span = 0.45,
  B = 1000,
  deg = 1,
  ncores = max(1, detectCores() - 1),
  length_out = 1000,
  downsample = 1,
  n_strata = 50,
  k_max = Inf,
  jitter_eps = 0,
  ci_method = c("percentile", "basic", "bc"),
  ci_adjust = c("none", "analytic"),
  min_rel_width = 0,
  widen_span = 0.1,
  curve_name = "LR_curve2",
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing Lee's L and correlation matrices.}

\item{grid_name}{Grid layer name to operate on.}

\item{level}{Correlation level (`cell` or `grid`).}

\item{lee_stats_layer}{Lee statistics layer name.}

\item{span}{LOESS span parameter.}

\item{B}{Number of bootstrap iterations.}

\item{deg}{Degree for the LOESS fit.}

\item{ncores}{Number of threads to use.}

\item{length_out}{Grid size for the fitted curve.}

\item{downsample}{Optional downsampling rate for points.}

\item{n_strata}{Number of strata used when drawing bootstrap samples.}

\item{k_max}{Numeric threshold.}

\item{jitter_eps}{Optional jitter applied to correlation values.}

\item{ci_method}{Confidence interval method to use.}

\item{ci_adjust}{Optional analytic adjustment for CI width.}

\item{min_rel_width}{Numeric threshold.}

\item{widen_span}{Parameter value.}

\item{curve_name}{Parameter value.}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
The modified `scope_object` with stored curve data.
}
\description{
Internal helper for `.compute_l_vs_r_curve`.
Computes a LOESS-based relationship between Lee's L and Pearson correlation
with bootstrap confidence intervals.
}
\keyword{internal}
