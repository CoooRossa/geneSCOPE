% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_misc.R
\name{.compute_module_density_similarity}
\alias{.compute_module_density_similarity}
\title{Compute module-level similarity from density layers}
\usage{
.compute_module_density_similarity(
  scope_obj,
  grid_name = "grid30",
  density_cols = NULL,
  density_pattern = "_density$",
  method = c("jaccard", "pearson", "spearman", "cosine"),
  density_threshold = 0,
  normalize = TRUE,
  min_grids_per_module = 5L,
  top_n_modules = NULL,
  output_dir = NULL,
  heatmap_bg = "#c0c0c0"
)
}
\arguments{
\item{scope_obj}{geneSCOPE object containing density layers.}

\item{grid_name}{Grid layer name (default "grid30").}

\item{density_cols}{Optional explicit density columns to use.}

\item{density_pattern}{Regex to select density columns (default "_density$").}

\item{method}{Similarity metric: "jaccard", "pearson", "spearman", "cosine".}

\item{density_threshold}{Threshold for binarization (Jaccard) or presence.}

\item{normalize}{Whether to z-score densities before similarity (default TRUE).}

\item{min_grids_per_module}{Minimum grids required per module.}

\item{top_n_modules}{Optional cap on number of modules; NULL keeps all.}

\item{output_dir}{Ignored (kept for backward compatibility; no files saved).}

\item{heatmap_bg}{Background color used when drawing the heatmap.}
}
\value{
List with: matrix (similarity), modules (names), grid, method,
  threshold, min_grids, heatmap (ComplexHeatmap object), palette (color
  function), labels (clean module labels).
}
\description{
Internal helper for `.compute_module_density_similarity`.
Computes similarity between module density profiles using Jaccard, Pearson,
Spearman, or cosine. Optionally z-score normalizes densities and filters
modules with insufficient grid coverage. Returns the similarity matrix and a
ComplexHeatmap object; no files are written.
}
\keyword{internal}
