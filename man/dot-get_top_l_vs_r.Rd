% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_leesL.R
\name{.get_top_l_vs_r}
\alias{.get_top_l_vs_r}
\title{Rank gene pairs by Lee's L vs Pearson r}
\usage{
.get_top_l_vs_r(
  scope_obj,
  grid_name,
  pear_level = c("cell", "grid"),
  lee_stats_layer = "LeeStats_Xz",
  expr_layer = NULL,
  pear_range = c(-1, 1),
  L_range = c(-1, 1),
  top_n = 10,
  direction = c("largest", "smallest", "both"),
  do_perm = TRUE,
  perms = 1000,
  block_side = 8,
  use_blocks = TRUE,
  ncores = 1,
  clamp_mode = c("none", "ref_only", "both"),
  p_adj_mode = c("BH", "BY", "BH_universe", "BY_universe", "bonferroni"),
  mem_limit_GB = 2,
  pval_mode = c("beta", "mid", "uniform"),
  curve_layer = NULL,
  CI_rule = c("remove_within", "remove_outside", "none"),
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing Lee's L and correlation matrices.}

\item{grid_name}{Grid layer name.}

\item{pear_level}{Correlation level (`cell` or `grid`).}

\item{lee_stats_layer}{Lee statistics layer name.}

\item{expr_layer}{Layer name.}

\item{pear_range}{Parameter value.}

\item{L_range}{Parameter value.}

\item{top_n}{Number of top pairs to return.}

\item{direction}{Direction of Delta selection (`both`, `pos`, `neg`).}

\item{do_perm}{Parameter value.}

\item{perms}{Number of permutations for p-value estimation.}

\item{block_side}{Parameter value.}

\item{use_blocks}{Logical flag.}

\item{ncores}{Number of threads to use for permutation testing.}

\item{clamp_mode}{Parameter value.}

\item{p_adj_mode}{Parameter value.}

\item{mem_limit_GB}{Parameter value.}

\item{pval_mode}{Parameter value.}

\item{curve_layer}{Optional precomputed curve layer from `.compute_l_vs_r_curve`.}

\item{CI_rule}{Parameter value.}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
A data.frame of top pairs with statistics.
}
\description{
Internal helper for `.get_top_l_vs_r`.
Retrieves top gene pairs with large deviations between Lee's L and Pearson
correlation, with optional confidence interval filtering and permutation
testing.
}
\keyword{internal}
