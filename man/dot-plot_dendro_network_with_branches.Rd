% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_misc.R, R/internal_plotting.R
\name{.plot_dendro_network_with_branches}
\alias{.plot_dendro_network_with_branches}
\title{Plot Dendro Network With Branches}
\usage{
.plot_dendro_network_with_branches(
  scope_obj,
  grid_name = NULL,
  lee_stats_layer = "LeeStats_Xz",
  gene_subset = NULL,
  L_min = 0,
  drop_isolated = TRUE,
  use_consensus_graph = TRUE,
  graph_slot_name = "g_consensus",
  cluster_vec = NULL,
  IDelta_col_name = NULL,
  damping = 0.85,
  weight_low_cut = 0,
  cluster_palette = c("#E41A1C", "#377EB8", "#4DAF4A", "#FF7F00", "#FFFF33", "#A65628",
    "#984EA3", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F",
    "#E5C494"),
  vertex_size = 8,
  base_edge_mult = 12,
  label_cex = 3,
  seed = 1,
  hub_factor = 3,
  length_scale = 1,
  max.overlaps = 20,
  hub_border_col = "#4B4B4B",
  hub_border_size = 0.8,
  show_sign = FALSE,
  neg_linetype = "dashed",
  neg_legend_lab = "Negative",
  pos_legend_lab = "Positive",
  show_qc_caption = TRUE,
  title = NULL,
  k_top = 1,
  tree_mode = c("rooted", "radial", "forest"),
  enable_subbranch = TRUE,
  cluster_id = NULL,
  include_root = TRUE,
  max_subclusters = 10,
  fallback_community = TRUE,
  min_sub_size = 3,
  community_method = c("louvain", "leiden"),
  subbranch_palette = c("#999999", "#D55E00", "#0072B2", "#009E73", "#CC79A7", "#F0E442",
    "#56B4E9", "#E69F00"),
  downstream_min_size = NULL,
  force_split = TRUE,
  main_fraction_cap = 0.9,
  core_periph = TRUE,
  core_degree_quantile = 0.75,
  core_min_fraction = 0.05,
  degree_gini_threshold = 0.35,
  verbose = TRUE
)

.plot_dendro_network_with_branches(
  scope_obj,
  grid_name = NULL,
  lee_stats_layer = "LeeStats_Xz",
  gene_subset = NULL,
  L_min = 0,
  drop_isolated = TRUE,
  use_consensus_graph = TRUE,
  graph_slot_name = "g_consensus",
  cluster_vec = NULL,
  IDelta_col_name = NULL,
  damping = 0.85,
  weight_low_cut = 0,
  cluster_palette = c("#E41A1C", "#377EB8", "#4DAF4A", "#FF7F00", "#FFFF33", "#A65628",
    "#984EA3", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F",
    "#E5C494"),
  vertex_size = 8,
  base_edge_mult = 12,
  label_cex = 3,
  seed = 1,
  hub_factor = 3,
  length_scale = 1,
  max.overlaps = 20,
  hub_border_col = "#4B4B4B",
  hub_border_size = 0.8,
  show_sign = FALSE,
  neg_linetype = "dashed",
  neg_legend_lab = "Negative",
  pos_legend_lab = "Positive",
  show_qc_caption = TRUE,
  title = NULL,
  k_top = 1,
  tree_mode = c("rooted", "radial", "forest"),
  enable_subbranch = TRUE,
  cluster_id = NULL,
  include_root = TRUE,
  max_subclusters = 10,
  fallback_community = TRUE,
  min_sub_size = 3,
  community_method = c("louvain", "leiden"),
  subbranch_palette = c("#999999", "#D55E00", "#0072B2", "#009E73", "#CC79A7", "#F0E442",
    "#56B4E9", "#E69F00"),
  downstream_min_size = NULL,
  force_split = TRUE,
  main_fraction_cap = 0.9,
  core_periph = TRUE,
  core_degree_quantile = 0.75,
  core_min_fraction = 0.05,
  degree_gini_threshold = 0.35,
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object`.}

\item{grid_name}{Grid layer name (or `NULL` to use the active layer).}

\item{lee_stats_layer}{Layer name.}

\item{gene_subset}{Parameter value.}

\item{L_min}{Numeric threshold.}

\item{drop_isolated}{Parameter value.}

\item{use_consensus_graph}{Logical flag.}

\item{graph_slot_name}{Slot name.}

\item{cluster_vec}{Parameter value.}

\item{IDelta_col_name}{Parameter value.}

\item{damping}{Parameter value.}

\item{weight_low_cut}{Parameter value.}

\item{cluster_palette}{Parameter value.}

\item{vertex_size}{Parameter value.}

\item{base_edge_mult}{Parameter value.}

\item{label_cex}{Parameter value.}

\item{seed}{Random seed.}

\item{hub_factor}{Parameter value.}

\item{length_scale}{Parameter value.}

\item{max.overlaps}{Parameter value.}

\item{hub_border_col}{Parameter value.}

\item{hub_border_size}{Parameter value.}

\item{show_sign}{Parameter value.}

\item{neg_linetype}{Parameter value.}

\item{neg_legend_lab}{Parameter value.}

\item{pos_legend_lab}{Parameter value.}

\item{show_qc_caption}{Parameter value.}

\item{title}{Parameter value.}

\item{k_top}{Parameter value.}

\item{tree_mode}{Parameter value.}

\item{enable_subbranch}{Whether to enable branch subclustering refinement (default TRUE)}

\item{cluster_id}{Optional character vector: clusters to subcluster split only; NULL=all}

\item{include_root}{Whether articulation point method includes articulation points in each branch}

\item{max_subclusters}{Maximum number of subclusters to retain per cluster (greedy deduplication by size)}

\item{fallback_community}{Whether to fall back to community detection when articulation points yield no results}

\item{min_sub_size}{Minimum size threshold for subclusters in community fallback mode}

\item{community_method}{Priority order of community detection algorithms}

\item{subbranch_palette}{Subcluster color palette: 1st color = remaining/unrefined, others cycle for subclusters}

\item{downstream_min_size}{Downstream subtree size threshold (NULL = adaptive)}

\item{force_split}{Whether to attempt relaxed acceptance conditions when original community split fails}

\item{main_fraction_cap}{Maximum community proportion threshold (allows retention of smaller communities even when exceeded)}

\item{core_periph}{Allow core-periphery splitting}

\item{core_degree_quantile}{Core degree threshold quantile}

\item{core_min_fraction}{Minimum core fraction}

\item{degree_gini_threshold}{Degree Gini threshold that triggers core-periphery splitting}

\item{verbose}{Logical; whether to emit progress messages.}

\item{g_slot}{Slot name.}

\item{cluster_name}{Parameter value.}

\item{legend_title}{Parameter value.}

\item{node_size}{Parameter value.}

\item{edge_width}{Parameter value.}

\item{label_size}{Parameter value.}

\item{label_nodes}{Parameter value.}

\item{min_degree_hub}{Numeric threshold.}

\item{edge_thresh}{Parameter value.}

\item{prune_mode}{Parameter value.}

\item{attach_I_delta}{Parameter value.}

\item{I_delta_name}{Parameter value.}

\item{I_delta_palette}{Parameter value.}
}
\value{
A `ggplot` object (or a list of plot components) used internally.

list(plot, graph, subclusters, subcluster_df, cluster_df, method_subcluster,
             base_network, branch_network, params)
}
\description{
Internal helper for `.plot_dendro_network_with_branches`.

Calls existing \code{.plot_dendro_network()} to build tree/skeleton network, then performs
"articulation point branching" subclustering refinement on specified clusters (or all clusters);
if no candidates and \code{fallback_community=TRUE} is set,
falls back to Louvain/Leiden community splitting. Outputs new network plot with subcluster coloring.
}
\keyword{internal}
