% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_misc.R, R/internal_plotting.R
\name{.plot_density_centroids}
\alias{.plot_density_centroids}
\title{Plot Density Centroids}
\usage{
.plot_density_centroids(
  scope_obj,
  gene1_name,
  gene2_name,
  palette1 = "#fc3d5d",
  palette2 = "#4753f8",
  size1 = 0.3,
  size2 = 0.3,
  alpha1 = 1,
  alpha2 = 0.5,
  seg_type = c("none", "cell", "nucleus", "both"),
  colour_cell = "black",
  colour_nucleus = "#3182bd",
  alpha_seg = 0.2,
  grid_gap = 100,
  scale_text_size = 2.4,
  bar_len = 400,
  bar_offset = 0.01,
  arrow_pt = 4,
  scale_legend_colour = "black",
  max.cutoff1 = 1,
  max.cutoff2 = 1
)

.plot_density_centroids(
  scope_obj,
  gene1_name,
  gene2_name,
  palette1 = "#fc3d5d",
  palette2 = "#4753f8",
  size1 = 0.3,
  size2 = 0.3,
  alpha1 = 1,
  alpha2 = 0.5,
  seg_type = c("none", "cell", "nucleus", "both"),
  colour_cell = "black",
  colour_nucleus = "#3182bd",
  alpha_seg = 0.2,
  grid_gap = 100,
  scale_text_size = 2.4,
  bar_len = 400,
  bar_offset = 0.01,
  arrow_pt = 4,
  scale_legend_colour = "black",
  max.cutoff1 = 1,
  max.cutoff2 = 1
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing `coord$centroids`, segmentation
vertices, and `cells$counts`.}

\item{gene1_name}{Character. Name of the first gene.}

\item{gene2_name}{Character. Name of the second gene.}

\item{palette1}{Colour used for cells expressing `gene1`. Default "#fc3d5d".}

\item{palette2}{Colour used for cells expressing `gene2`. Default "#4753f8".}

\item{size1}{Point size for `gene1` cells. Default 0.3.}

\item{size2}{Point size for `gene2` cells. Default 0.3.}

\item{alpha1}{Maximum alpha for `gene1` cells. Default 0.7.}

\item{alpha2}{Maximum alpha for `gene2` cells. Default 0.7.}

\item{seg_type}{Segmentation overlay type: "none", "cell", "nucleus",
or "both". Default "none".}

\item{colour_cell}{Line colour for cell segmentation. Default "black".}

\item{colour_nucleus}{Line colour for nucleus segmentation. Default "#3182bd".}

\item{alpha_seg}{Alpha for segmentation polygons. Default 0.2.}

\item{grid_gap}{Spacing of background grid lines (µm). Default 100.}

\item{scale_text_size}{Font size for scale-bar text. Default 2.4.}

\item{bar_len}{Length of the scale bar (µm). Default 400.}

\item{bar_offset}{Vertical offset of the scale bar as a fraction of the y-range. Default 0.01.}

\item{arrow_pt}{Arrow-head size of the scale bar. Default 4.}

\item{scale_legend_colour}{Colour of the scale-bar text and line. Default "black".}

\item{max.cutoff1}{Fraction (0-1) of gene1's maximum expression used for clipping. Default 1.}

\item{max.cutoff2}{Fraction (0-1) of gene2's maximum expression used for clipping. Default 1.}
}
\value{
A `ggplot` object (or a list of plot components) used internally.

A `ggplot` object.
}
\description{
Internal helper for `.plot_density_centroids`.

Plots cell centroids coloured by the normalised expression of two specified genes.
  Expression values are extracted from `scope_obj@cells$counts`, min-max scaled
  to 0-1 separately for each gene, and mapped to point transparency (`alpha`) so
  that higher expression appears more opaque. Centroids of cells expressing
  `gene1` are drawn with `palette1`; centroids of cells expressing `gene2` with
  `palette2`. Cells that express neither gene are not shown. Optionally overlays
  cell/nucleus segmentation polygons.
}
\keyword{internal}
