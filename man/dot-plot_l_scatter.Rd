% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal_plotting.R
\name{.plot_l_scatter}
\alias{.plot_l_scatter}
\title{Plot L Scatter}
\usage{
.plot_l_scatter(
  scope_obj,
  grid_name = NULL,
  lee_stats_layer = NULL,
  title = NULL
)

.plot_l_scatter(
  scope_obj,
  grid_name = NULL,
  lee_stats_layer = NULL,
  title = NULL
)
}
\arguments{
\item{scope_obj}{An object containing
`scope_obj@grid[[grid_name]]$counts` and
`scope_obj@grid[[grid_name]][[lee_stats_layer]]$L`.}

\item{grid_name}{Character (optional). The name of the grid sublayer to use.
If NULL and `scope_obj@grid` has exactly one sublayer,
that sublayer is used automatically. Otherwise, it must be provided.}

\item{lee_stats_layer}{Character (optional). The name of the LeeStats layer (e.g., `"LeeStats_Xz"`).
If NULL, the function searches for exactly one layer under
`scope_obj@grid[[grid_name]]` whose name starts with `"LeeStats_"`.
If multiple matches are found, an error is thrown and the user must
supply `lee_stats_layer` explicitly.}

\item{title}{Character (optional). Plot title. Defaults to
`"Lee's L vs. Fold Change (All Gene Pairs)"` if NULL.}
}
\value{
A `ggplot` object (or a list of plot components) used internally.

A `ggplot2` object showing a scatterplot of Lee's L vs. fold change
        for all gene pairs (i < j).
}
\description{
Internal helper for `.plot_l_scatter`.

For a given `scope_obj`, extract the Lee's L matrix from
  `scope_obj@grid[[grid_name]][[lee_stats_layer]]$L`.
  Summarize each gene's total count across all grid cells from
  `scope_obj@grid[[grid_name]]$counts`. For every gene pair (i, j) with i < j,
  compute Lee's L and the fold change of their total counts
  (fold change = max(total_i, total_j) / min(total_i, total_j), â‰¥ 1).
  Finally, plot a scatterplot with Lee's L on the x-axis and fold change on
  the y-axis, using a 25% gray background and publication-quality aesthetics.
}
\keyword{internal}
