% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_leesL.R
\name{getTopLvsR}
\alias{getTopLvsR}
\title{Extract top L vs R pairs.}
\usage{
getTopLvsR(
  scope_obj,
  grid_name,
  pear_level = c("cell", "grid"),
  lee_stats_layer = "LeeStats_Xz",
  expr_layer = NULL,
  pear_range = c(-1, 1),
  L_range = c(-1, 1),
  top_n = 10,
  direction = c("largest", "smallest", "both"),
  do_perm = TRUE,
  perms = 1000,
  block_side = 8,
  use_blocks = TRUE,
  ncores = 1,
  clamp_mode = c("none", "ref_only", "both"),
  p_adj_mode = c("BH", "BY", "BH_universe", "BY_universe", "bonferroni"),
  mem_limit_GB = 2,
  pval_mode = c("beta", "mid", "uniform"),
  curve_layer = NULL,
  CI_rule = c("remove_within", "remove_outside", "none"),
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` containing Lee's L and correlation matrices.}

\item{grid_name}{Grid layer name.}

\item{pear_level}{Correlation level (`cell` or `grid`).}

\item{lee_stats_layer}{Lee statistics layer name.}

\item{expr_layer}{Optional expression layer name for gene prevalence filtering.}

\item{pear_range}{Range of Pearson r values to include.}

\item{L_range}{Range of Lee's L values to include.}

\item{top_n}{Number of top pairs to return.}

\item{direction}{Which tail to select (`largest`, `smallest`, `both`).}

\item{do_perm}{Whether to run permutation testing.}

\item{perms}{Number of permutations for p-value estimation.}

\item{block_side}{Block side length used when building permutation blocks.}

\item{use_blocks}{Whether to use spatial blocks for permutations.}

\item{ncores}{Number of threads to use.}

\item{clamp_mode}{Whether to clamp Delta using reference-only or both ends.}

\item{p_adj_mode}{Multiple-testing adjustment mode.}

\item{mem_limit_GB}{Memory threshold controlling chunking behavior.}

\item{pval_mode}{P-value mode used when transforming permutation counts.}

\item{curve_layer}{Optional curve layer from `computeLvsRCurve()`.}

\item{CI_rule}{Confidence-interval filtering rule (`remove_within`, `remove_outside`, `none`).}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
A data.frame with ranked gene pairs and associated statistics.
}
\description{
Ranks gene pairs by the deviation between Lee's L and Pearson correlation and
returns a table of top pairs.
}
\examples{
\dontrun{
scope_obj <- computeL(scope_obj, grid_name = "grid30", ncores = 16)
scope_obj <- computeCorrelation(scope_obj, level = "cell", layer = "logCPM", ncores = 16)
top_pairs <- getTopLvsR(scope_obj, grid_name = "grid30", top_n = 200, ncores = 16, L_range = c(0.1, 1))
head(top_pairs)
}
}
\seealso{
`computeL()`, `computeCorrelation()`, `computeLvsRCurve()`
}
