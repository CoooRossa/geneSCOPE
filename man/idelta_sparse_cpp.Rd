% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{idelta_sparse_cpp}
\alias{idelta_sparse_cpp}
\title{Sparse Morisita's Iδ for gene–grid count matrices}
\usage{
idelta_sparse_cpp(G, n_threads = 1L)
}
\arguments{
\item{G}{\code{g × q} sparse numeric matrix (\code{dgCMatrix}) whose
rows are genes and columns are grids.}

\item{n_threads}{Integer. Number of OpenMP threads to use (default 1).}
}
\value{
Numeric vector of length \code{g}.  Values are \code{NaN} for
  genes with fewer than two total molecules.
}
\description{
Computes Morisita's index Iδ for every gene (row) in a sparse
  count matrix, where columns are spatial grids.  Only the non-zero
  entries of each row are visited, so the runtime is \eqn{O(nnz)} and
  memory use is negligible.  The calculation is fully parallelised
  with OpenMP.
}
\details{
For each gene the statistic is
  \deqn{I_\delta = q \frac{\sum_{i=1}^{q} x_i (x_i - 1)}
                    {\operatorname{tot}(\operatorname{tot}-1)},}
  where \eqn{x_i} is the count in grid \eqn{i} and
  \eqn{\operatorname{tot} = \sum_i x_i}.  The factor \eqn{q} corrects
  for the number of grids.
}
\examples{
\dontrun{
Idelta <- idelta_sparse_cpp(G, n_threads = 4)
summary(Idelta)
}
}
