% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{lee_perm_block}
\alias{lee_perm_block}
\title{Block-wise permutation counts for Lee's L}
\usage{
lee_perm_block(Xz, W, idx_mat, block_ids, L_ref, n_threads = 1L)
}
\arguments{
\item{Xz}{n × g numeric matrix of z-scored expression (rows = cells).}

\item{W}{n × n sparse weight matrix in \code{dgCMatrix} format.}

\item{idx_mat}{n × B integer matrix of 0-based permutation indices.}

\item{block_ids}{n-length integer vector; identical IDs denote the same block.}

\item{L_ref}{g × g reference Lee's L matrix.}

\item{n_threads}{Integer. Number of OpenMP threads (default 1).}
}
\value{
g × g integer matrix of exceedance counts.
}
\description{
Performs Monte-Carlo permutations constrained within blocks
  (e.g. slides or images) and returns exceedance counts versus the reference
  statistic.
}
