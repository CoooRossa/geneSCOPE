% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Normalization.r
\name{normalizeCells_CPMlog}
\alias{normalizeCells_CPMlog}
\title{Add log-CPM normalised matrix to a CoordObj}
\usage{
normalizeCells_CPMlog(
  coordObj,
  input_layer = "counts",
  output_layer = "logCPM",
  scale_factor = 10000
)
}
\arguments{
\item{coordObj}{A \code{CoordObj}.}

\item{input_layer}{Character. Name of the existing layer to read
(must be a \code{dgCMatrix} inside
\code{coordObj@cells}); default \code{"counts"}.}

\item{output_layer}{Character. Name of the layer to write to
(will overwrite if exists); default \code{"logCPM"}.}

\item{scale_factor}{Numeric. Library size each cell is scaled to
before log1p; default 1e4.}
}
\value{
The modified \code{CoordObj} (invisibly).
}
\description{
Reads the specified layer (default \code{"counts"}) from
\code{coordObj@cells}, converts to counts-per-\code{scale_factor}
(default 10 000), applies \code{log1p}, and stores the result as
a new layer (default \code{"logCPM"}).  The modified object is
returned invisibly so you can overwrite the original variable:

\preformatted{
    P5.coord <- normalizeCells_CPMlog(P5.coord)
  }
}
