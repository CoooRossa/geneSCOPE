% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_normalization.R
\name{normalizeMoleculesInGrid}
\alias{normalizeMoleculesInGrid}
\title{Normalize grid counts to Z-score expression.}
\usage{
normalizeMoleculesInGrid(
  scope_obj,
  grid_name = NULL,
  keep_zero_grids = FALSE,
  row_norm = TRUE,
  zero_var_to_zero = TRUE,
  var_eps = 0,
  mem_dense_limit = 2e+11,
  verbose = TRUE
)
}
\arguments{
\item{scope_obj}{A `scope_object` that already contains a grid layer.}

\item{grid_name}{Target grid sub-layer; if `NULL`, the sole sub-layer is used.}

\item{keep_zero_grids}{Whether to keep grids whose counts are all zero.}

\item{row_norm}{Whether to perform row normalization before Z scoring.}

\item{zero_var_to_zero}{Whether to zero columns with standard deviation <= `var_eps`.}

\item{var_eps}{Standard deviation threshold below which columns are set to zero.}

\item{mem_dense_limit}{Threshold for `nrow * ncol`; values above this still
coerce to dense with a warning (default `2e11`, roughly 16 GB for doubles).}

\item{verbose}{Emit progress messages when TRUE.}
}
\value{
The modified `scope_object` (invisibly) containing a new `Xz` layer.
}
\description{
Builds a grid-by-gene count matrix from a grid layer, optionally performs
row normalization, converts to dense, and applies column-wise Z scoring
(sample SD) to produce an `Xz` expression layer.
}
\examples{
\dontrun{
scope_obj <- createSCOPE(data_dir = "/path/to/output_dir", grid_length = 30)
scope_obj <- normalizeMoleculesInGrid(scope_obj, grid_name = "grid30")
}
}
