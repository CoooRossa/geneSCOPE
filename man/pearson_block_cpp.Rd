% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{pearson_block_cpp}
\alias{pearson_block_cpp}
\title{Block-wise Pearson correlation (parallel C++)}
\usage{
pearson_block_cpp(X, bs = 2000L, n_threads = 1L)
}
\arguments{
\item{X}{\eqn{n \times p} double matrix whose columns have already been
mean-centred in R.}

\item{bs}{Integer. Number of variables (columns) per block; controls the
memoryâ€“speed trade-off (default 2000).}

\item{n_threads}{Integer. Number of OpenMP threads (default 1).}
}
\value{
A \eqn{p \times p} symmetric double matrix containing Pearson
correlations.
}
\description{
Computes the Pearson correlation matrix for a column-centred numeric
matrix \code{X} using a tiled (block-wise) multiplication strategy and
OpenMP parallelism.  Only one block is kept in memory at a time, so the
peak RAM footprint is \eqn{O(bs^2)} where \code{bs} is the block size.
}
\details{
Column standard deviations are pre-computed, then each block pair
multiplies \eqn{X_i^\top X_j / (n-1)} to obtain the covariance
sub-matrix, which is scaled by the corresponding standard deviations
to yield correlations.  Upper-triangular blocks are written first and
mirrored into the lower triangle under a critical section to avoid
write-race conditions.
}
\examples{
\dontrun{
R <- pearson_block_cpp(X, bs = 1500, n_threads = 4)
}
}
