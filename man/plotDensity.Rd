% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotDensity.r
\name{plotDensity}
\alias{plotDensity}
\title{Plot Density Heatmap with Segmentation Overlay (Full Grid)}
\usage{
plotDensity(
  coordObj,
  grid_name,
  density1_name,
  density2_name = NULL,
  palette1 = "#fc3d5d",
  palette2 = "#4753f8",
  alpha1 = 0.5,
  alpha2 = 0.5,
  seg_type = c("cell", "nucleus", "both"),
  colour_cell = "black",
  colour_nucleus = "#3182bd",
  alpha_seg = 0.2,
  grid_gap = 100,
  scale_text_size = 2.4,
  bar_len = 400,
  bar_offset = 0.01,
  arrow_pt = 4,
  scale_legend_colour = "black",
  max.cutoff1 = 1,
  max.cutoff2 = 1,
  legend_digits = 1
)
}
\arguments{
\item{coordObj}{A \code{coordObj} object that must contain:
\code{coordObj@grid[[grid_name]]$grid_info} (columns: \code{grid_id}, \code{xmin}, \code{xmax}, \code{ymin}, \code{ymax})
\code{coordObj@grid[[grid_name]]$densityDF}  (rownames are \code{grid_id})
\code{coordObj@coord$segmentation}           (\code{x}, \code{y}, \code{cell})}

\item{grid_name}{Character, e.g. "grid_lenGrid50".}

\item{density1_name}{Character. Column name of the first density layer in \code{densityDF}.}

\item{density2_name}{Character (optional). Column name of the second density layer in \code{densityDF}.}

\item{palette1}{Colour for high values in the first density. Default \code{"#fc3d5d"}.}

\item{palette2}{Colour for high values in the second density. Default \code{"#4753f8"}.}

\item{alpha1}{Alpha for the first layer (0–1). Default \code{0.5}.}

\item{alpha2}{Alpha for the second layer (0–1). Default \code{0.5}.}

\item{seg_type}{Character string: one of "cell", "nucleus", or "both".}

\item{colour_cell}{Line colour for cell segmentation polygons. Default "black".}

\item{colour_nucleus}{Line colour for nucleus segmentation polygons. Default \code{"#3182bd"}.}

\item{alpha_seg}{Alpha of the segmentation overlay. Default \code{0.2}.}

\item{grid_gap}{Spacing of grid lines. Default \code{100}.}

\item{scale_text_size}{Font size for scale‑bar text. Default \code{2.4}.}

\item{bar_len}{Length of the scale bar. Default \code{400}.}

\item{bar_offset}{Vertical offset of the scale bar as a fraction of the y‑range. Default \code{0.01}.}

\item{arrow_pt}{Arrow‑head size of the scale bar. Default \code{4}.}

\item{scale_legend_colour}{Colour of the scale‑bar and legend text. Default "black".}

\item{max.cutoff1}{Fraction (0–1) of the first density's maximum used for clipping. Default \code{1}.}

\item{max.cutoff2}{Fraction (0–1) of the second density's maximum used for clipping. Default \code{1}.}

\item{legend_digits}{Number of decimal places in legend labels. Default \code{1}.}
}
\value{
\if{html}{\out{<div class="sourceCode">}}\preformatted{         A `ggplot` object.
}\if{html}{\out{</div>}}

\if{html}{\out{<div class="sourceCode">}}\preformatted{         A `ggplot` object.
}\if{html}{\out{</div>}}
}
\description{
Based on \code{coordObj@grid[[grid_name]]}'s \code{grid_info} and \code{densityDF}:
\enumerate{
\item Draw a complete continuous density heatmap so that \strong{all} grids (including those with no
expression values) are rendered. Grids that are absent in \code{densityDF} or whose expression is NA
are treated as zero and filled with the "zero‑expression" colour, ensuring the heatmap covers
the entire frame with no gaps.
\item Overlay the segmentation polygons (alpha adjustable).
\item Re‑use the visual style of \code{plotCoordObjSpatial()}: black outer border, bottom/left axes only,
equal aspect ratio, and whitespace padding around the panel (\code{plot.margin}).
}

Based on \code{coordObj@grid[[grid_name]]}'s \code{grid_info} and \code{densityDF}:
\enumerate{
\item Draw a complete continuous density heatmap so that \strong{all} grids (including those with no
expression values) are rendered. Grids that are absent in \code{densityDF} or whose expression is NA
are treated as zero and filled with the "zero‑expression" colour, ensuring the heatmap covers
the entire frame with no gaps.
\item Overlay the segmentation polygons (alpha adjustable).
\item Re‑use the visual style of \code{plotCoordObjSpatial()}: black outer border, bottom/left axes only,
equal aspect ratio, and whitespace padding around the panel (\code{plot.margin}).
}
}
