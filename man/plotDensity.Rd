% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4.PlotDensity.r
\name{plotDensity}
\alias{plotDensity}
\title{plotDensity - visualise grid-level density stored in @density}
\usage{
plotDensity(
  coordObj,
  grid_name,
  density1_name,
  density2_name = NULL,
  palette1 = "#fc3d5d",
  palette2 = "#4753f8",
  alpha1 = 0.5,
  alpha2 = 0.5,
  seg_type = c("cell", "nucleus", "both"),
  colour_cell = "black",
  colour_nucleus = "#3182bd",
  alpha_seg = 0.2,
  grid_gap = 100,
  scale_text_size = 2.4,
  bar_len = 400,
  bar_offset = 0.01,
  arrow_pt = 4,
  scale_legend_colour = "black",
  max.cutoff1 = 1,
  max.cutoff2 = 1,
  legend_digits = 1
)
}
\arguments{
\item{coordObj}{A \code{CoordObj}.}

\item{grid_name}{Name of the grid layer to plot (e.g. "grid_lenGrid50").}

\item{density1_name, density2_name}{Column names to plot.}

\item{palette1, palette2}{Color palettes for density1 and density2.}

\item{alpha1, alpha2}{Alpha transparency for density layers.}

\item{seg_type}{Segmentation overlay type: "cell", "nucleus", or "both".}

\item{colour_cell, colour_nucleus}{Colors for cell and nucleus segmentation.}

\item{alpha_seg}{Alpha transparency for segmentation overlay.}

\item{grid_gap}{Spacing for background grid lines.}

\item{scale_text_size}{Font size for scale bar text.}

\item{bar_len}{Length of scale bar in micrometers.}

\item{bar_offset}{Vertical offset of scale bar as fraction of y-range.}

\item{arrow_pt}{Arrow point size for scale bar.}

\item{scale_legend_colour}{Color of scale bar and text.}

\item{max.cutoff1, max.cutoff2}{Maximum cutoff fractions for density values.}

\item{legend_digits}{Number of decimal places in legend.}
}
\value{
A \code{ggplot} object.
}
\description{
Draws one (or two) continuous heatmaps for density columns previously
created by \code{computeDensity()}.
this function first looks there but will fall back to the legacy
\code{coordObj@grid[[grid_name]]$densityDF} if necessary.
All other functionality (dual-scale heatmap, segmentation overlay,
square aspect, grid lines, scale bar) is preserved.
}
\details{
4.PlotDensity.r (2025-01-06 rev)
}
