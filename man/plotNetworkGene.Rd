% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotNetWork.r
\name{plotNetworkGene}
\alias{plotNetworkGene}
\title{Plot Gene Co-distribution Network with Cluster Coloring}
\usage{
plotNetworkGene(
  coordObj,
  grid_name = NULL,
  lee_stats_layer = "LeeStats",
  gene_subset = NULL,
  cluster_vec = NULL,
  cluster_palette = c("#E41A1C", "#377EB8", "#4DAF4A", "#FF7F00", "#FFFF33", "#A65628",
    "#984EA3", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F",
    "#E5C494"),
  L_min = 0.15,
  L_min_neg = NULL,
  p_cut = NULL,
  drop_isolated = TRUE,
  weight_abs = TRUE,
  vertex_size = 8,
  base_edge_mult = 12,
  label_cex = 3,
  layout_niter = 1000,
  seed = 1,
  hub_factor = 3,
  max.overlaps = 20,
  L_max = 1,
  hub_border_col = "#4B4B4B",
  hub_border_size = 0.8,
  show_sign = FALSE,
  neg_linetype = "dashed",
  neg_legend_lab = "Negative",
  pos_legend_lab = "Positive",
  show_qc_caption = TRUE,
  title = NULL
)
}
\arguments{
\item{coordObj}{A \strong{\code{CoordObj}} containing spatial‐grid statistics
produced by downstream FG²CLI helpers.}

\item{grid_name}{Character. Name of the grid sub-layer (e.g.
\code{"grid_lenGrid50"}). If \code{NULL}, the single available
grid layer is used.}

\item{lee_stats_layer}{Character. Slot name that stores Lee’s \emph{L} results
inside the chosen grid sub-layer. Default \code{"LeeStats"}.}

\item{gene_subset}{Optional character vector of gene names to keep.}

\item{cluster_vec}{Either a named vector mapping genes to clusters, or a
single string giving the column name inside
\code{coordObj@meta.data} that contains cluster labels.}

\item{cluster_palette}{Character vector of colours (named or unnamed) used
to paint clusters. Unnamed palettes are re-cycled
with \code{colorRampPalette()}.}

\item{L_min}{Minimum |L| retained when \code{weight_abs = TRUE}.}

\item{L_min_neg}{Separate threshold for negative edges when
\code{weight_abs = FALSE}.  Default uses \code{L_min}.}

\item{p_cut}{Optional \emph{P}-value cutoff (used if a \code{P} matrix exists
inside the LeeStats layer).}

\item{drop_isolated}{Logical. Drop nodes with zero degree after thresholding.}

\item{weight_abs}{Logical. If \code{TRUE}, edge sign is ignored when filtering
(\verb{|L| >= L_min}).  If \code{FALSE}, separate thresholds are
applied for positive/negative edges.}

\item{vertex_size}{Base node size (passed to \code{ggplot2}).}

\item{base_edge_mult}{Multiplier controlling the thickest edge width.}

\item{label_cex}{Node-label text size.}

\item{layout_niter}{Number of iterations for the Fruchterman-Reingold
layout.}

\item{seed}{Random seed for reproducible layouts.}

\item{hub_factor}{Nodes with degree > \verb{hub_factor × median(deg)} are
treated as hubs and drawn with a border.}

\item{max.overlaps}{Passed to \code{geom_node_text(repel = TRUE)} to limit
label collisions.}

\item{L_max}{Absolute |L| values larger than this are discarded.}

\item{hub_border_col}{Colour of hub borders.}

\item{hub_border_size}{Stroke width of hub borders.}

\item{show_sign}{Logical. If \code{TRUE}, positive/negative edges are drawn
with different linetypes.}

\item{neg_linetype}{Linetype used for negative edges when \code{show_sign = TRUE}.}

\item{neg_legend_lab}{Legend label for negative edges.}

\item{pos_legend_lab}{Legend label for positive edges.}

\item{show_qc_caption}{Logical. Appends a one-line QC caption if the LeeStats
layer contains a \verb{$qc} list.}

\item{title}{Optional plot title.}
}
\value{
A \strong{\code{ggplot}} object (class \code{ggraph_tbl_graph}).
}
\description{
Generates a publication-quality network plot in which edges represent
significant Lee’s \emph{L} spatial correlations between genes, and nodes are
coloured by a user-supplied cluster assignment (e.g. Louvain clusters).
Positive and negative correlations can be visualised with different
linetypes; hub genes (high-degree nodes) are outlined for emphasis, and
an optional QC caption summarises network statistics is printed below the
figure.
}
\examples{
\dontrun{
p <- plotNetworkClu(
  coordObj     = P5.coord,
  grid_name    = "grid_lenGrid50",
  cluster_vec  = P5.coord@meta.data$louvain_Xz_top0.1_grid50,
  gene_subset  = head(colnames(P5.coord@grid$grid_lenGrid50$Counts), 300)
)
print(p)
}
}
