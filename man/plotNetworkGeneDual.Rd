% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotNetWork.r
\name{plotNetworkGeneDual}
\alias{plotNetworkGeneDual}
\title{Plot Gene Co‑distribution Network – Dual Metrics & Cluster Subsetting}
\usage{
plotNetworkGeneDual(
  coordObj,
  grid_name = NULL,
  lee_stats_layer = "LeeStats",
  lee_minusR_layer = NULL,
  gene_subset = NULL,
  cluster_vec = NULL,
  cluster_select,
  second_layer = "LeeMinusR_bycell",
  cluster_palette = NULL,
  L_min = 0.15,
  L_min_neg = NULL,
  drop_isolated = TRUE,
  weight_abs = TRUE,
  vertex_size = 8,
  base_edge_mult = 12,
  metric_edge_mult = 6,
  layout_niter = 1000,
  seed = 1,
  show_sign = FALSE,
  neg_linetype = "dashed",
  title = NULL
)
}
\arguments{
\item{coordObj}{A \strong{\code{CoordObj}} containing spatial‐grid statistics
produced by downstream FG²CLI helpers.}

\item{grid_name}{Character. Name of the grid sub-layer (e.g.
\code{"grid_lenGrid50"}). If \code{NULL}, the single available
grid layer is used.}

\item{lee_stats_layer}{Character. Slot name that stores Lee’s \emph{L} results
inside the chosen grid sub-layer. Default \code{"LeeStats"}.}

\item{gene_subset}{Optional character vector of gene names to keep.}

\item{cluster_vec}{Either a named vector mapping genes to clusters, or a
single string giving the column name inside
\code{coordObj@meta.data} that contains cluster labels.}

\item{cluster_select}{Character or numeric vector. Only genes whose
cluster label equals (\code{==}) or is contained in
(\code{\%in\%}) this vector are shown.}

\item{second_layer}{Character. Name of the layer used for the lower curve.
One of \code{"LeeMinusR_bycell"}, \code{"LeeMinusR_bygrid"},
\code{"pearson_cor_cell"}, \code{"pearson_cor_grid"}.
Default = \code{"LeeMinusR_bycell"}.}

\item{cluster_palette}{Character vector of colours (named or unnamed) used
to paint clusters. Unnamed palettes are re-cycled
with \code{colorRampPalette()}.}

\item{L_min}{Minimum |L| retained when \code{weight_abs = TRUE}.}

\item{L_min_neg}{Separate threshold for negative edges when
\code{weight_abs = FALSE}.  Default uses \code{L_min}.}

\item{drop_isolated}{Logical. Drop nodes with zero degree after thresholding.}

\item{weight_abs}{Logical. If \code{TRUE}, edge sign is ignored when filtering
(\verb{|L| >= L_min}).  If \code{FALSE}, separate thresholds are
applied for positive/negative edges.}

\item{vertex_size}{Base node size (passed to \code{ggplot2}).}

\item{base_edge_mult}{Multiplier controlling the thickest edge width.}

\item{metric_edge_mult}{Multiplier controlling the thickest width of the
lower (metric) edges.}

\item{layout_niter}{Number of iterations for the Fruchterman-Reingold
layout.}

\item{seed}{Random seed for reproducible layouts.}

\item{show_sign}{Logical. If \code{TRUE}, positive/negative edges are drawn
with different linetypes.}

\item{neg_linetype}{Linetype used for negative edges when \code{show_sign = TRUE}.}

\item{title}{Optional plot title.}
}
\value{
A \strong{\code{ggplot}} object.
}
\description{
Extends \code{plotNetworkGene()} by \strong{(i)} restricting the plot to genes whose
cluster assignment (\code{cluster_vec}) matches one or more user‑supplied values,
and \strong{(ii)} drawing \strong{two axially symmetric edges} between every retained
gene pair:
\itemize{
\item \strong{Upper curve (positive curvature)} — Lee’s \emph{L} (as in
\code{plotNetworkGene()}), coloured by cluster.
\item \strong{Lower curve (negative curvature)} — a second metric chosen from one of
the following layers (argument \code{second_layer}):
\code{"LeeMinusR_bycell"}, \code{"LeeMinusR_bygrid"},
\code{"pearson_cor_cell"}, or \code{"pearson_cor_grid"}.
The lower curve is grey; its width is proportional to
\code{abs(metric)}, and linetype encodes sign (solid = positive, dashed = negative).
}
}
